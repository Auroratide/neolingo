import{r as b,q as y,t as A,v as I,w as x,A as g,U as n,x as z}from"./runtime.D6qGRyYZ.js";import{r as _,h as L}from"./disclose-version.BhNNnOgD.js";import{t as N}from"./if.DwhKEA2U.js";function S(){return{d:null,e:null,p:x,n:!0,r:null,t:g}}function q(u,v,m,p,k){const s=S();let r=null;L(u);let c,f=n,o=n,i=!1;s.r=e=>{const l=r,t=l.s;t.add(e),e.f(()=>{t.delete(e),t.size===0&&r!==l&&l.e!==null&&(l.d!==null&&(_(l.d),l.d=null),I(l.e),l.e=null)})};const d=()=>{const e={d:null,e:null,s:new Set,p:r},l=b(()=>{o===n?f===n?(s.n=!0,m!==null&&m(u)):p!==null&&(s.n=!1,p(u,f)):k!==null&&(s.n=!1,k(u,o)),e.d=s.d,s.d=null},s,!0,!0);e.e=l,r=e},a=()=>{const e=r;if(e===null){d();return}const l=e.s;l.size===0?(e.d!==null&&(_(e.d),e.d=null),e.e?z(e.e):d()):(d(),N(l,"out"))},w=b(()=>{const e={};c=e;const l=v();y(l)?(l.then(t=>{c===e&&(A(),f=t,i=!1,a())},t=>{o=t,i=!1,a()}),(f!==n||o!==n)&&(o=n,f=n),i||(i=!0,a())):(o=n,f=l,i=!1,a())},s,!1);w.ondestroy=()=>{let e=r;for(c={};e!==null;){const l=e.d;l!==null&&_(l);const t=e.e;t!==null&&I(t),e=e.p}},s.e=w}export{q as a};
